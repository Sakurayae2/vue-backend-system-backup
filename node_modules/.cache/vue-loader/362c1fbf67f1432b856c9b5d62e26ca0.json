{"remainingRequest":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\src\\views\\award\\cancel.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\src\\views\\award\\cancel.vue","mtime":1637930052000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_babel-loader@8.2.3@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldENhbmNlbCwgY2FuY2VsQXdhIH0gZnJvbSAnQC9hcGkvYXdhcmQnCmltcG9ydCBxcyBmcm9tICdxcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2FuY2VsJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VycmVudERhdGU6ICcnLAogICAgICBzZWxlY3Q6ICd1c2VyJywKICAgICAgcm9vbVVpbjogJycsCiAgICAgIGNhbmNlbGxpc3Q6IFtdLAogICAgICBvbmVXZWVrOiBbXSwKICAgICAgYmx1cmZsYWc6IHRydWUKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFllc3RlcmRheVRpbWUoKQogICAgLy8gdGhpcy5nZXRDYW5jZWxMaXN0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldENhbmNlbExpc3QoKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuc2VsZWN0KQogICAgICB0aGlzLmNhbmNlbGxpc3QgPSBbXQogICAgICBnZXRDYW5jZWwoeyBpZHR5cGU6IHRoaXMuc2VsZWN0LCB1aW46IHRoaXMucm9vbVVpbiB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKQogICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5yZXREYXRhLmRhdGFMaXN0CiAgICAgICAgY29uc3QgcmVzVHlwZSA9IHJlcy5kYXRhLnJldERhdGEuc3RhdHVzQ29kZSA9PT0gNDAxID8gJ3dhcm5pbmcnIDogJ3N1Y2Nlc3MnCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiByZXNUeXBlLAogICAgICAgICAgbWVzc2FnZTogcmVzLmRhdGEucmV0RGF0YS5tc2cKICAgICAgICB9KQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgdGhpcy5jYW5jZWxsaXN0LnB1c2goewogICAgICAgICAgICB1aW46IGRhdGFbaV0udWluLAogICAgICAgICAgICBhd2FyZFR5cGU6IGRhdGFbaV0udHlwZSwKICAgICAgICAgICAgc3RhdHVzOiBkYXRhW2ldLmRhdGUKICAgICAgICAgIH0pCiAgICAgICAgICAvLyAwLDHovazmjaLkuLpmYWxzZSx0cnVlCiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuY2FuY2VsbGlzdFtpXS5zdGF0dXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgdGhpcy5jYW5jZWxsaXN0W2ldLnN0YXR1c1tqXSA9IEJvb2xlYW4odGhpcy5jYW5jZWxsaXN0W2ldLnN0YXR1c1tqXSkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5ibHVyZmxhZyA9IHRydWUKICAgICAgfSkKICAgICAgLy8gdGhpcy4kaHR0cAogICAgICAvLyAgIC5nZXQoJ2h0dHA6Ly8xOTIuMTY4LjIuMTQxOjE5MTAwL2FwaS9wd2FwaS9hY3RpdmUvYmFja2VuZC9jYW5jZWxhd2FyZCcsIHsgcGFyYW1zOiB7IGlkdHlwZTogdGhpcy5zZWxlY3QsIHVpbjogdGhpcy5yb29tVWluIH19KQogICAgICAvLyAgIC50aGVuKHJlcyA9PiB7CiAgICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhyZXMpCiAgICAgIC8vICAgICBjb25zdCBkYXRhID0gcmVzLmRhdGEucmV0RGF0YS5kYXRhTGlzdAogICAgICAvLyAgICAgY29uc3QgcmVzVHlwZSA9IHJlcy5kYXRhLnJldERhdGEuc3RhdHVzQ29kZSA9PT0gNDAxID8gJ3dhcm5pbmcnIDogJ3N1Y2Nlc3MnCiAgICAgIC8vICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgLy8gICAgICAgdHlwZTogcmVzVHlwZSwKICAgICAgLy8gICAgICAgbWVzc2FnZTogcmVzLmRhdGEucmV0RGF0YS5tc2cKICAgICAgLy8gICAgIH0pCiAgICAgIC8vICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgLy8gICAgICAgdGhpcy5jYW5jZWxsaXN0LnB1c2goewogICAgICAvLyAgICAgICAgIHVpbjogZGF0YVtpXS51aW4sCiAgICAgIC8vICAgICAgICAgYXdhcmRUeXBlOiBkYXRhW2ldLnR5cGUsCiAgICAgIC8vICAgICAgICAgc3RhdHVzOiBkYXRhW2ldLmRhdGUKICAgICAgLy8gICAgICAgfSkKICAgICAgLy8gICAgICAgLy8gMCwx6L2s5o2i5Li6ZmFsc2UsdHJ1ZQogICAgICAvLyAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuY2FuY2VsbGlzdFtpXS5zdGF0dXMubGVuZ3RoOyBqKyspIHsKICAgICAgLy8gICAgICAgICB0aGlzLmNhbmNlbGxpc3RbaV0uc3RhdHVzW2pdID0gQm9vbGVhbih0aGlzLmNhbmNlbGxpc3RbaV0uc3RhdHVzW2pdKQogICAgICAvLyAgICAgICB9CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICB0aGlzLmJsdXJmbGFnID0gdHJ1ZQogICAgICAvLyAgIH0pCiAgICB9LAogICAgY2FuY2VsQXdhcmQoc2NvcGVJbmRleCwgaW5kZXgpIHsKICAgICAgY29uc3QgZGF0YSA9IHsKICAgICAgICB1aW46IHRoaXMuY2FuY2VsbGlzdFtzY29wZUluZGV4XS51aW4sCiAgICAgICAgdHlwZTogdGhpcy5jYW5jZWxsaXN0W3Njb3BlSW5kZXhdLmF3YXJkVHlwZSwKICAgICAgICBkYXRlOiB0aGlzLm9uZVdlZWtbaW5kZXhdLAogICAgICAgIGlkdHlwZTogdGhpcy5zZWxlY3QKICAgICAgfQogICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKQogICAgICBjYW5jZWxBd2EocXMuc3RyaW5naWZ5KGRhdGEpKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgIG1lc3NhZ2U6ICfmk43kvZzmiJDlip8nCiAgICAgICAgfSkKICAgICAgfSkKICAgICAgLy8gdGhpcy4kaHR0cAogICAgICAvLyAgIC5wb3N0KCdodHRwOi8vMTkyLjE2OC4yLjE0MToxOTEwMC9hcGkvcHdhcGkvYWN0aXZlL2JhY2tlbmQvY2FuY2VsYXdhcmQnLCBxcy5zdHJpbmdpZnkoZGF0YSkpCiAgICAgIC8vICAgLnRoZW4oKCkgPT4gewogICAgICAvLyAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgIC8vICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgLy8gICAgICAgbWVzc2FnZTogJ+aTjeS9nOaIkOWKnycKICAgICAgLy8gICAgIH0pCiAgICAgIC8vICAgfSkKICAgIH0sCiAgICAvLyDmjqfliLbmkJzntKLkuK1ibHVy44CBY2xpY2vkuI3ooqvlkIzml7bop6blj5EKICAgIGJsdXJHZXRDYW5jZWxMaXN0KCkgewogICAgICB0aGlzLmJsdXJmbGFnID0gZmFsc2UKICAgICAgdGhpcy5nZXRDYW5jZWxMaXN0KCkKICAgIH0sCiAgICAvLyDojrflj5bml6XmnJ8KICAgIGdldFllc3RlcmRheVRpbWUoKSB7CiAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpCiAgICAgIHZhciB5ZWFyID0gbm93LmdldEZ1bGxZZWFyKCkKICAgICAgdmFyIG1vbnRoID0gbm93LmdldE1vbnRoKCkKICAgICAgdmFyIGRhdGUgPSBub3cuZ2V0RGF0ZSgpCiAgICAgIG1vbnRoID0gbW9udGggKyAxCiAgICAgIG1vbnRoID0gbW9udGgudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpCiAgICAgIGRhdGUgPSBkYXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKQogICAgICB0aGlzLmN1cnJlbnREYXRlID0gYCR7eWVhcn0tJHttb250aH0tJHtkYXRlfWAKICAgICAgLy8g6YCS5YeP5ZGoCiAgICAgIC8vIGZvciAodmFyIGkgPSAwOyBpIDwgNzsgaSsrLCBkYXRlLS0pIHsKICAgICAgLy8gICBpZiAoZGF0ZSA8IDEwKSB7IGRhdGUgPSBkYXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSB9CiAgICAgIC8vICAgaWYgKGRhdGUgPD0gMCkgewogICAgICAvLyAgICAgbW9udGggPSAoLS1tb250aCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpCiAgICAgIC8vICAgICBkYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDApLmdldERhdGUoKQogICAgICAvLyAgIH0KICAgICAgLy8gICBpZiAobW9udGggPD0gMCkgeyB5ZWFyLS07IG1vbnRoID0gMTIgfQogICAgICAvLyAgIHRoaXMub25lV2Vlay5wdXNoKGAke3llYXJ9LSR7bW9udGh9LSR7ZGF0ZX1gKQogICAgICAvLyB9CiAgICAgIC8vIOmAkuWinuWRqAogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDc7IGkrKywgZGF0ZSsrKSB7CiAgICAgICAgaWYgKGRhdGUgPiBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkuZ2V0RGF0ZSgpKSB7CiAgICAgICAgICBkYXRlID0gMQogICAgICAgICAgbW9udGggPSAoKyttb250aCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpCiAgICAgICAgfQogICAgICAgIGlmIChtb250aCA+IDEyKSB7IHllYXIrKyB9CiAgICAgICAgZGF0ZSA9IGRhdGUudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpCiAgICAgICAgdGhpcy5vbmVXZWVrLnB1c2goYCR7eWVhcn0tJHttb250aH0tJHtkYXRlfWApCiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["cancel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cancel.vue","sourceRoot":"src/views/award","sourcesContent":["<template>\n  <div>\n    <!-- 卡片视图 -->\n    <el-card>\n      <!-- 搜索 日期选择 -->\n      <el-row :gutter=\"20\" style=\"margin-bottom: 20px;\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"roomUin\" placeholder=\"请输入ID\" @blur=\"blurGetCancelList\">\n            <el-select slot=\"prepend\" v-model=\"select\" placeholder=\"请选择\" clearable style=\"width: 100px;\">\n              <el-option label=\"用户ID\" value=\"user\" />\n              <el-option label=\"房间ID\" value=\"room\" />\n            </el-select>\n            <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"blurflag&&getCancelList()\" />\n          </el-input>\n        </el-col>\n        <el-col style=\"width: 200px\">\n          <el-input type=\"text\" placeholder=\"tips:勾选代表取消奖励\" disabled />\n        </el-col>\n      </el-row>\n      <!-- 取消奖励列表区域 -->\n      <el-table :data=\"cancellist\" border stripe>\n        <el-table-column type=\"index\" label=\"#\" align=\"center\" />\n        <!--<el-table-column prop=\"uin\" label=\"uin\" width=\"120px\" align=\"center\" />-->\n        <el-table-column prop=\"awardType\" label=\"奖励类型\" width=\"120px\" align=\"center\" />\n        <el-table-column prop=\"status\" label=\"操作\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-row>\n              <el-col>\n                <el-checkbox\n                  v-for=\"(item, index) in oneWeek\"\n                  :key=\"index\"\n                  v-model=\"cancellist[scope.$index].status[index]\"\n                  :checked=\"cancellist[scope.$index].status[index]\"\n                  border\n                  style=\"margin: 5px\"\n                  @change=\"cancelAward(scope.$index, index)\"\n                >{{ item }}</el-checkbox>\n              </el-col>\n            </el-row>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { getCancel, cancelAwa } from '@/api/award'\nimport qs from 'qs'\n\nexport default {\n  name: 'Cancel',\n  data() {\n    return {\n      currentDate: '',\n      select: 'user',\n      roomUin: '',\n      cancellist: [],\n      oneWeek: [],\n      blurflag: true\n    }\n  },\n  created() {\n    this.getYesterdayTime()\n    // this.getCancelList()\n  },\n  methods: {\n    getCancelList() {\n      // console.log(this.select)\n      this.cancellist = []\n      getCancel({ idtype: this.select, uin: this.roomUin }).then(res => {\n        // console.log(res)\n        const data = res.data.retData.dataList\n        const resType = res.data.retData.statusCode === 401 ? 'warning' : 'success'\n        this.$message({\n          type: resType,\n          message: res.data.retData.msg\n        })\n        for (var i = 0; i < data.length; i++) {\n          this.cancellist.push({\n            uin: data[i].uin,\n            awardType: data[i].type,\n            status: data[i].date\n          })\n          // 0,1转换为false,true\n          for (var j = 0; j < this.cancellist[i].status.length; j++) {\n            this.cancellist[i].status[j] = Boolean(this.cancellist[i].status[j])\n          }\n        }\n        this.blurflag = true\n      })\n      // this.$http\n      //   .get('http://192.168.2.141:19100/api/pwapi/active/backend/cancelaward', { params: { idtype: this.select, uin: this.roomUin }})\n      //   .then(res => {\n      //     // console.log(res)\n      //     const data = res.data.retData.dataList\n      //     const resType = res.data.retData.statusCode === 401 ? 'warning' : 'success'\n      //     this.$message({\n      //       type: resType,\n      //       message: res.data.retData.msg\n      //     })\n      //     for (var i = 0; i < data.length; i++) {\n      //       this.cancellist.push({\n      //         uin: data[i].uin,\n      //         awardType: data[i].type,\n      //         status: data[i].date\n      //       })\n      //       // 0,1转换为false,true\n      //       for (var j = 0; j < this.cancellist[i].status.length; j++) {\n      //         this.cancellist[i].status[j] = Boolean(this.cancellist[i].status[j])\n      //       }\n      //     }\n      //     this.blurflag = true\n      //   })\n    },\n    cancelAward(scopeIndex, index) {\n      const data = {\n        uin: this.cancellist[scopeIndex].uin,\n        type: this.cancellist[scopeIndex].awardType,\n        date: this.oneWeek[index],\n        idtype: this.select\n      }\n      // console.log(data)\n      cancelAwa(qs.stringify(data)).then(() => {\n        this.$message({\n          type: 'success',\n          message: '操作成功'\n        })\n      })\n      // this.$http\n      //   .post('http://192.168.2.141:19100/api/pwapi/active/backend/cancelaward', qs.stringify(data))\n      //   .then(() => {\n      //     this.$message({\n      //       type: 'success',\n      //       message: '操作成功'\n      //     })\n      //   })\n    },\n    // 控制搜索中blur、click不被同时触发\n    blurGetCancelList() {\n      this.blurflag = false\n      this.getCancelList()\n    },\n    // 获取日期\n    getYesterdayTime() {\n      var now = new Date()\n      var year = now.getFullYear()\n      var month = now.getMonth()\n      var date = now.getDate()\n      month = month + 1\n      month = month.toString().padStart(2, '0')\n      date = date.toString().padStart(2, '0')\n      this.currentDate = `${year}-${month}-${date}`\n      // 递减周\n      // for (var i = 0; i < 7; i++, date--) {\n      //   if (date < 10) { date = date.toString().padStart(2, '0') }\n      //   if (date <= 0) {\n      //     month = (--month).toString().padStart(2, '0')\n      //     date = new Date(year, month, 0).getDate()\n      //   }\n      //   if (month <= 0) { year--; month = 12 }\n      //   this.oneWeek.push(`${year}-${month}-${date}`)\n      // }\n      // 递增周\n      for (var i = 0; i < 7; i++, date++) {\n        if (date > new Date(year, month, 0).getDate()) {\n          date = 1\n          month = (++month).toString().padStart(2, '0')\n        }\n        if (month > 12) { year++ }\n        date = date.toString().padStart(2, '0')\n        this.oneWeek.push(`${year}-${month}-${date}`)\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n</style>\n\n"]}]}