{"remainingRequest":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\src\\views\\award\\punish.vue?vue&type=style&index=0&id=1ecf8261&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\src\\views\\award\\punish.vue","mtime":1637930052000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_css-loader@3.6.0@css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_postcss-loader@3.0.0@postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Sakura\\Downloads\\Compressed\\suibo_backup_system\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5zZWFjaElucHV0IHsKICB3aWR0aDogNDAwcHg7CiAgbWFyZ2luOiAwIDIwcHggMTBweCAwOwp9CgouYWRkSXRlbSB7CiAgd2lkdGg6IDUwMHB4Owp9Ci5yb29tVHlwZSB7CiAgbWFyZ2luLXJpZ2h0OiAyMHB4Owp9Cg=="},{"version":3,"sources":["punish.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4QA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"punish.vue","sourceRoot":"src/views/award","sourcesContent":["<template>\n  <div>\n    <!-- 卡片视图 -->\n    <el-card style=\"margin: 10px;\">\n      <el-input\n        v-model=\"queryInfo.uin\"\n        class=\"seachInput\"\n        placeholder=\"请输入uin\"\n        clearable\n        @keyup.enter.native=\"getList()\"\n      >\n        <el-button slot=\"append\" icon=\"el-icon-search\" @click.native=\"getList()\"/>\n      </el-input>\n      <el-radio-group v-model=\"roomType\" class=\"roomType\" @change=\"getList()\">\n        <el-radio-button label=\"sing\">唱歌房间</el-radio-button>\n        <el-radio-button label=\"dance\">广场舞房间</el-radio-button>\n        <el-radio-button label=\"chess\">象棋房间</el-radio-button>\n      </el-radio-group>\n      <transition name=\"fade\" mode=\"out-in\">\n        <el-form\n          v-if=\"addPunishFalg\"\n          ref=\"addPunishForm\"\n          style=\"width:500px;margin: 0;\"\n          :rules=\"addPunishFormRules\"\n          :model=\"addPunishForm\"\n          label-width=\"100px\"\n        >\n          <el-form-item label=\"房间类型\" prop=\"type\">\n            <el-select v-model=\"addPunishForm.type\" placeholder=\"请选择房间类型\">\n              <el-option label=\"唱歌房间\" value=\"sing\"></el-option>\n              <el-option label=\"广场舞房间\" value=\"dance\"></el-option>\n              <el-option label=\"象棋房间\" value=\"chess\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item class=\"addItem\" label=\"处罚uin\" prop=\"uin\">\n            <el-input\n              v-model=\"addPunishForm.uin\"\n              placeholder=\"请输入uin,如:123或123,456,仅广场舞房间可输入房间号\"\n              @keyup.enter.native=\"addPunishment\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item class=\"addItem\" label=\"处罚原因\" prop=\"reason\">\n            <el-autocomplete\n              v-model=\"addPunishForm.reason\"\n              :fetch-suggestions=\"querySearch\"\n              style=\"width:100%\"\n              placeholder=\"请输入处罚原因\"\n              @keyup.enter.native=\"addPunishment\"\n            ></el-autocomplete>\n          </el-form-item>\n          <el-form-item class=\"addItem\" label=\"处罚\" prop=\"result\">\n            <el-autocomplete\n              v-model=\"addPunishForm.result\"\n              :fetch-suggestions=\"querySearch\"\n              style=\"width:100%\"\n              placeholder=\"请输入处罚\"\n              @keyup.enter.native=\"addPunishment\"\n            ></el-autocomplete>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"addPunishment\">添加处罚</el-button>\n            <el-button @click=\"addPunishFalg=false\">取消</el-button>\n            <el-button @click=\"resetForm('addPunishForm')\">重置</el-button>\n          </el-form-item>\n        </el-form>\n\n        <el-button v-else type=\"primary\" @click=\"loadAll\">添加处罚</el-button>\n      </transition>\n\n      <!-- 表格 -->\n      <el-table :data=\"punishList\" stripe style=\"width: 100%\">\n        <el-table-column label=\"房间类型\" align=\"center\">\n          {{ roomTypeName[roomType] }}\n        </el-table-column>\n        <el-table-column prop=\"date\" label=\"日期\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"uin\" label=\"uin/roomid\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"nick\" label=\"昵称\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"reason\" label=\"处罚原因\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"result\" label=\"惩罚\" align=\"center\"></el-table-column>\n        <el-table-column prop=\"handle\" label=\"操作\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-button type=\"text\" @click.native.prevent=\"deleteRow(scope.row,scope.$index)\">移除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!-- 分页区域 -->\n      <el-pagination\n        :current-page=\"show.page\"\n        :page-sizes=\"[20, 30, 50]\"\n        :page-size=\"show.size\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"show.totle\"\n        style=\"margin-top: 20px;\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n      />\n\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { getPunish, addPunish, removePunish } from '@/api/award'\nimport qs from 'qs'\n\nexport default {\n  data() {\n    // 自定义规则\n    var checkUins = (rule, value, callback) => {\n      const regEmail = /^(\\d*)(,\\d*)*$/\n      if (regEmail.test(value)) {\n        // 合法\n        return callback()\n      }\n      callback(new Error('请输入正确格式，如:123,456'))\n    }\n    return {\n      roomTypeName: {\n        sing: '唱歌房间',\n        dance: '广场舞房间',\n        chess: '象棋房间'\n      },\n      reasonAdvice: [],\n      addPunishFalg: false,\n      roomType: 'sing',\n      addPunishForm: {\n        type: 'sing',\n        // date: '',\n        uin: '',\n        reason: '',\n        result: '',\n        passwd: 'taolesoft0571'\n      },\n      // 查询\n      queryInfo: {\n        uin: '',\n        passwd: 'taolesoft0571'\n      },\n      show: {\n        page: 1,\n        size: 20,\n        totle: 0\n      },\n      punishListCache: [],\n      punishList: [],\n      addPunishFormRules: {\n        uin: [\n          { required: true, message: '请输入uin', trigger: 'blur' },\n          { validator: checkUins, trigger: 'blur' }\n        ],\n        reason: [\n          { required: true, message: '请输入处罚原因', trigger: 'change' }\n        ],\n        result: [\n          { required: true, message: '请输入处罚', trigger: 'change' }\n        ]\n      }\n    }\n  },\n  created() {\n    this.getList()\n  },\n  beforeDestroy() {\n    localStorage.removeItem('reasonAdvice')\n  },\n  methods: {\n    roomSwitch() {\n      console.log(this.addPunishForm.type, this.roomType)\n    },\n    // 处罚原因和处罚建议\n    querySearch(queryString, cb) {\n      var reasonAdvice = this.reasonAdvice\n      var results = queryString ? reasonAdvice.filter(this.createFilter(queryString)) : reasonAdvice\n      // 调用 callback 返回建议列表的数据\n      cb(results)\n    },\n    createFilter(queryString) {\n      return (restaurant) => {\n        return (restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0)\n      }\n    },\n    loadAll() {\n      this.addPunishFalg = true\n      if (JSON.parse(localStorage.getItem('reasonAdvice') !== null)) {\n        this.reasonAdvice = JSON.parse(localStorage.getItem('reasonAdvice'))\n      } else {\n        this.reasonAdvice = [\n          { value: '假唱' }\n        ]\n      }\n    },\n    // 获取处罚列表\n    getList() {\n      this.queryInfo.type = this.roomType\n      getPunish(this.queryInfo).then(res => {\n        this.punishListCache = res.data.retData.dataList\n        this.punishList = this.punishListCache.slice((this.show.page - 1) *\n          this.show.size, this.show.page * this.show.size)\n        this.show.totle = this.punishListCache.length\n      })\n    },\n    // 添加处罚\n    addPunishment() {\n      this.$refs.addPunishForm.validate(valid => {\n        if (valid) {\n          addPunish(qs.stringify(this.addPunishForm)).then(res => {\n            //   console.log(res)\n            if (res.data.retData.statusCode === 200) {\n              this.reasonAdvice.push({ value: this.addPunishForm.reason })\n              this.reasonAdvice.push({ value: this.addPunishForm.result })\n              localStorage.setItem('reasonAdvice', JSON.stringify(this.reasonAdvice))\n              this.reasonAdvice = JSON.parse(localStorage.getItem('reasonAdvice'))\n              this.getList()\n              this.resetForm('addPunishForm')\n              this.$message.success('添加处罚成功')\n            } else {\n              this.$message.error(res.data.retData.msg)\n            }\n          })\n        }\n      })\n    },\n    // 移除处罚\n    deleteRow(row, index) {\n      this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        const data = {\n          passwd: 'taolesoft0571',\n          uin: row.uin,\n          date: row.date\n        }\n        removePunish(qs.stringify(data)).then(res => {\n          if (res.data.retData.statusCode === 200) {\n            this.punishList.splice(index, 1)\n            this.$message.success('移除处罚成功')\n          } else {\n            this.$message.error('移除处罚失败')\n          }\n        })\n      }).catch(() => {\n        this.$message.info('已取消删除')\n      })\n    },\n    // 重置\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n    // 监听 pagesize 改变的事件\n    async handleSizeChange(newSize) {\n      this.show.size = newSize\n      this.punishList = this.punishListCache.slice((this.show.page - 1) *\n        this.show.size, this.show.page * this.show.size)\n    },\n    // 监听 页码值pagenum 改变事件\n    async handleCurrentChange(newSize) {\n      this.show.page = newSize\n      this.punishList = this.punishListCache.slice((this.show.page - 1) *\n        this.show.size, this.show.page * this.show.size)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.seachInput {\n  width: 400px;\n  margin: 0 20px 10px 0;\n}\n\n.addItem {\n  width: 500px;\n}\n.roomType {\n  margin-right: 20px;\n}\n</style>\n"]}]}