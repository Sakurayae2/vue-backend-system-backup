(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e3d0c3c"],{"0feb":function(e,t,i){"use strict";i.d(t,"g",(function(){return n})),i.d(t,"h",(function(){return l})),i.d(t,"a",(function(){return s})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return r})),i.d(t,"i",(function(){return d})),i.d(t,"d",(function(){return u})),i.d(t,"f",(function(){return c})),i.d(t,"b",(function(){return m}));var o=i("b775");function n(e){return Object(o["a"])({url:"/api/dwapi/system/permission/",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/api/dwapi/system/permission/"+e+"/",method:"get"})}function s(e){return Object(o["a"])({url:"/api/dwapi/system/permission/",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/api/dwapi/system/permission/"+e+"/",method:"delete"})}function r(e,t){return Object(o["a"])({url:"/api/dwapi/system/permission/"+e+"/",method:"patch",data:t})}function d(e){return Object(o["a"])({url:"/api/dwapi/system/menu/",method:"get",params:e})}function u(e){return Object(o["a"])({url:"/api/dwapi/system/menu/"+e+"/",method:"delete"})}function c(e,t){return Object(o["a"])({url:"/api/dwapi/system/menu/"+e+"/",method:"patch",data:t})}function m(e){return Object(o["a"])({url:"/api/dwapi/system/menu/",method:"post",data:e})}},d78e:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-card",[i("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("el-input",{attrs:{placeholder:"请输入ID",clearable:""},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getRolesList},slot:"append"})],1)],1),i("el-col",{attrs:{span:4}},[i("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:function(t){e.AddRoleDialogVisible=!0}}},[e._v("添加角色")])],1)],1),i("el-table",{attrs:{data:e.rolesList,border:"",stripe:""}},[i("el-table-column",{attrs:{type:"index",label:"#",align:"center"}}),i("el-table-column",{attrs:{label:"角色ID",prop:"id",align:"center"}}),i("el-table-column",{attrs:{label:"角色名称",prop:"roleName",align:"center"}}),i("el-table-column",{attrs:{label:"唯一标识key",prop:"key",align:"center"}}),i("el-table-column",{attrs:{label:"操作",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(i){return e.showEditDialog(t.row,t.$index)}}},[e._v("编辑 ")]),1!==t.row.id?i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(i){return e.removeRoleById(t.row.id)}}},[e._v("删除 ")]):e._e(),i("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(i){return e.showSetRightDialog(t.row)}}},[e._v("分配菜单 ")])]}}])})],1),i("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[10,15,20],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.totle},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),i("el-dialog",{attrs:{title:"分配权限",visible:e.setRightDialogVisible,width:"50%"},on:{"update:visible":function(t){e.setRightDialogVisible=t},close:e.setRightDialogClosed}},[i("el-tree",{ref:"treeRef",attrs:{data:e.menu,props:e.defaultProps,"show-checkbox":"","check-strictly":"","node-key":"id","default-expand-all":"","default-checked-keys":e.defKeys},on:{check:e.handleCheckChange}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.setRightDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.allotRights}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"添加角色",visible:e.AddRoleDialogVisible,width:"40%"},on:{"update:visible":function(t){e.AddRoleDialogVisible=t}}},[i("el-form",{ref:"addRoleFormRef",attrs:{model:e.addRoleForm,rules:e.addRoleFormRules,"label-width":"110px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{model:{value:e.addRoleForm.name,callback:function(t){e.$set(e.addRoleForm,"name",t)},expression:"addRoleForm.name"}})],1),i("el-form-item",{attrs:{label:"唯一标识key",prop:"key"}},[i("el-input",{model:{value:e.addRoleForm.key,callback:function(t){e.$set(e.addRoleForm,"key",t)},expression:"addRoleForm.key"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.AddRoleDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.addRoles}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"编辑角色",visible:e.editRoleDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editRoleDialogVisible=t}}},[i("el-form",{ref:"editRoleFormRef",attrs:{model:e.editRoleForm,rules:e.editRoleFormRules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{model:{value:e.editRoleForm.name,callback:function(t){e.$set(e.editRoleForm,"name",t)},expression:"editRoleForm.name"}})],1),i("el-form-item",{attrs:{label:"唯一标识",prop:"key"}},[i("el-input",{model:{value:e.editRoleForm.key,callback:function(t){e.$set(e.editRoleForm,"key",t)},expression:"editRoleForm.key"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.editRoleDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.editRoles}},[e._v("确 定")])],1)],1)],1)},n=[],l=(i("90df"),i("d8ae"),i("3abb"),i("cc5e")),s=i("0feb"),a={data:function(){return{defaultProps:{children:"child",label:"name"},queryInfo:{query:"",pagenum:1,pagesize:15},totle:0,rolesList:[],setRightDialogVisible:!1,rightsList:[],treeProps:{label:"authName",children:"children"},defKeys:[],currentNodeKey:[],AddRoleDialogVisible:!1,addRoleForm:{},addRoleFormRules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"角色的长度在2～10个字",trigger:"blur"}],key:[{required:!0,message:"请输入唯一标识",trigger:"blur"},{min:1,max:10,message:"角色的长度在1～10个字",trigger:"blur"}]},editRoleForm:{},editRoleDialogVisible:!1,editIndex:"",editRoleFormRules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"角色的长度在2～10个字",trigger:"blur"}],key:[{required:!0,message:"请输入唯一标识",trigger:"blur"}]},roleId:0,menu:[]}},created:function(){this.getRolesList()},methods:{getRolesList:function(){var e=this;this.rolesList=[];var t=this.queryInfo.query;if(t)Object(l["e"])(t).then((function(t){var i=t.data;e.rolesList.push({id:i.id,key:i.key,roleName:i.name}),e.$message.success("查询成功！")}));else{var i={page:this.queryInfo.pagenum,size:this.queryInfo.pagesize};Object(l["d"])(i).then((function(t){for(var i=t.data,o=0;o<i.length;o++)e.id=i[o].id,e.rolesList.push({id:i[o].id,key:i[o].key,roleName:i[o].name,menus:i[o].menus})}))}},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getRolesList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getRolesList()},setRightDialogClosed:function(){},addRoles:function(){var e=this,t={name:this.addRoleForm.name,key:this.addRoleForm.key};Object(l["a"])(t).then((function(){e.$message.success("添加角色成功！"),e.getRolesList()})),this.AddRoleDialogVisible=!1},removeRoleById:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["b"])(e).then((function(){t.getRolesList(),t.$message.success("删除成功！")}))})).catch((function(){t.$message.info("已取消删除")}))},showEditDialog:function(e,t){this.editIndex=t,this.editRoleForm.id=e.id,this.$set(this.editRoleForm,"name",e.roleName),this.$set(this.editRoleForm,"key",e.key),this.editRoleDialogVisible=!0},editRoles:function(){var e=this,t=this.editRoleForm.id,i={name:this.editRoleForm.name,key:this.editRoleForm.key};console.log(i),Object(l["c"])(t,i).then((function(){e.rolesList[e.editIndex].roleName=i.name,e.rolesList[e.editIndex].key=i.key,e.$message.success("修改角色信息成功！")})),this.editRoleDialogVisible=!1},getMenu:function(){var e=this,t={drop:!0,tree:!0,level:1};Object(s["i"])(t).then((function(t){e.menu=t.data}))},showSetRightDialog:function(e){var t=this;this.roleId=e.id,this.menu.length||this.getMenu(),this.defKeys.length||(this.defKeys=e.menus),this.$nextTick((function(){t.$refs.treeRef.setCheckedKeys(e.menus)})),this.setRightDialogVisible=!0},allotRights:function(){var e=this;Object(l["c"])(this.roleId,{menus:this.currentNodeKey}).then((function(){e.$message.success("分配菜单成功！"),e.defKeys=[],e.getRolesList()})),this.setRightDialogVisible=!1},handleCheckChange:function(){var e=this;this.currentNodeKey=[];var t=this.$refs.treeRef.getCheckedNodes(!1,!0);t.forEach((function(t){e.currentNodeKey.push(t.id)}))}}},r=a,d=i("cba8"),u=Object(d["a"])(r,o,n,!1,null,"13feeef8",null);t["default"]=u.exports}}]);