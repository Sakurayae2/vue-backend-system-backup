{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d0af86f\"],{\"0f69\":function(e,t,s){\"use strict\";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",[s(\"el-card\",[s(\"el-row\",{staticStyle:{\"margin-bottom\":\"20px\"},attrs:{gutter:20}},[s(\"el-col\",{attrs:{span:6}},[s(\"el-input\",{attrs:{placeholder:\"请输入ID\",clearable:\"\"},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,\"query\",t)},expression:\"queryInfo.query\"}},[s(\"el-button\",{attrs:{slot:\"append\",icon:\"el-icon-search\"},on:{click:e.getUserList},slot:\"append\"})],1)],1),s(\"el-col\",{attrs:{span:4}},[s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.showAddDialog}},[e._v(\"添加用户\")])],1)],1),s(\"el-table\",{attrs:{data:e.userlist,border:\"\",stripe:\"\"}},[s(\"el-table-column\",{attrs:{type:\"index\",label:\"#\",align:\"center\"}}),s(\"el-table-column\",{attrs:{prop:\"id\",label:\"ID\",width:\"80px\",align:\"center\"}}),s(\"el-table-column\",{attrs:{prop:\"username\",label:\"姓名\",align:\"center\"}}),s(\"el-table-column\",{attrs:{prop:\"email\",label:\"邮箱\",align:\"center\"}}),s(\"el-table-column\",{attrs:{prop:\"roles_name\",label:\"角色\",align:\"center\"}}),s(\"el-table-column\",{attrs:{label:\"状态\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[s(\"el-switch\",{model:{value:t.row.mg_state,callback:function(s){e.$set(t.row,\"mg_state\",s)},expression:\"scope.row.mg_state\"}})]}}])}),s(\"el-table-column\",{attrs:{label:\"操作\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[s(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-edit\",size:\"small\",circle:\"\"},on:{click:function(s){return e.showEditDialog(t.row)}}}),s(\"el-button\",{attrs:{type:\"danger\",icon:\"el-icon-delete\",size:\"small\",circle:\"\"},on:{click:function(s){return e.removeUserById(t.$index)}}})]}}])})],1),s(\"el-pagination\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"current-page\":e.queryInfo.pagenum,\"page-sizes\":[5,10,15],\"page-size\":e.queryInfo.pagesize,layout:\"total, sizes, prev, pager, next, jumper\",total:e.totle},on:{\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1),s(\"el-dialog\",{attrs:{title:\"添加用户\",visible:e.addDialogVisible,width:\"50%\"},on:{\"update:visible\":function(t){e.addDialogVisible=t}}},[s(\"el-form\",{attrs:{model:e.addUserForm,rules:e.addUserFormRules,\"label-width\":\"100px\"}},[s(\"el-form-item\",{attrs:{label:\"用户名\",prop:\"username\"}},[s(\"el-input\",{model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,\"username\",t)},expression:\"addUserForm.username\"}})],1),s(\"el-form-item\",{attrs:{label:\"邮箱\",prop:\"email\"}},[s(\"el-input\",{model:{value:e.addUserForm.email,callback:function(t){e.$set(e.addUserForm,\"email\",t)},expression:\"addUserForm.email\"}})],1),s(\"el-form-item\",{attrs:{label:\"分配角色\"}},[s(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择\"},model:{value:e.selectRoleId,callback:function(t){e.selectRoleId=t},expression:\"selectRoleId\"}},e._l(e.rolesList,(function(e){return s(\"el-option\",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)],1),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v(\"取 消\")]),s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.addUser}},[e._v(\"确 定\")])],1)],1),s(\"el-dialog\",{attrs:{title:\"修改用户信息\",visible:e.editDialogVisible,width:\"50%\"},on:{\"update:visible\":function(t){e.editDialogVisible=t}}},[s(\"el-form\",{attrs:{model:e.editUserForm,rules:e.editUserFormRules,\"label-width\":\"90px\"}},[s(\"el-form-item\",{attrs:{label:\"用户名\",prop:\"username\"}},[s(\"el-input\",{model:{value:e.editUserForm.username,callback:function(t){e.$set(e.editUserForm,\"username\",t)},expression:\"editUserForm.username\"}})],1),s(\"el-form-item\",{attrs:{label:\"邮箱\",prop:\"email\"}},[s(\"el-input\",{model:{value:e.editUserForm.email,callback:function(t){e.$set(e.editUserForm,\"email\",t)},expression:\"editUserForm.email\"}})],1),s(\"el-form-item\",{attrs:{label:\"当前角色\",prop:\"roles_name\"}},[e._v(\" \"+e._s(e.editUserForm.roles_name)+\" \")]),s(\"el-form-item\",{attrs:{label:\"分配角色\"}},[s(\"el-select\",{attrs:{multiple:\"\",placeholder:\"请选择\"},model:{value:e.selectRoleId,callback:function(t){e.selectRoleId=t},expression:\"selectRoleId\"}},e._l(e.rolesList,(function(e){return s(\"el-option\",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)],1),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"el-button\",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(\"取 消\")]),s(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.editUser}},[e._v(\"确 定\")])],1)],1)],1)},l=[],i=(s(\"b874\"),s(\"99d7\"),s(\"90df\"),s(\"c24f\")),a=s(\"cc5e\"),o={data:function(){var e=function(e,t,s){var r=/^\\w+@\\w+(\\.\\w+)+$/;if(r.test(t))return s();s(new Error(\"请输入合法邮箱\"))};return{queryInfo:{query:\"\",pagenum:1,pagesize:10},totle:0,userlist:[],addDialogVisible:!1,addUserForm:{username:\"\",email:\"\",roles:[]},addUserFormRules:{username:[{required:!0,message:\"请输入用户名\",trigger:\"blur\"},{min:2,max:10,message:\"用户名的长度在2～10个字\",trigger:\"blur\"}],email:[{required:!0,message:\"请输入邮箱\",trigger:\"blur\"},{validator:e,trigger:\"blur\"}]},editDialogVisible:!1,editUserForm:{},editUserFormRules:{username:[{required:!0,message:\"请输入用户名\",trigger:\"blur\"},{min:2,max:10,message:\"用户名的长度在2～10个字\",trigger:\"blur\"}],email:[{required:!0,message:\"请输入邮箱\",trigger:\"blur\"},{validator:e,trigger:\"blur\"}]},rolesList:[],selectRoleId:\"\"}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;this.userlist=[];var t=this.queryInfo.query;if(t)Object(i[\"g\"])(t).then((function(t){var s=t.data;e.userlist.push({id:s.id,username:s.username,email:s.email,roles:s.roles,roles_name:s.roles_name})}));else{var s={page:this.queryInfo.pagenum,size:this.queryInfo.pagesize};Object(i[\"f\"])(s).then((function(t){var s=t.data.results;e.totle=t.data.count;for(var r=0;r<s.length;r++)e.id=s[r].id,e.userlist.push({id:s[r].id,username:s[r].username,email:s[r].email,roles:s[r].roles,roles_name:s[r].roles_name+\"\"})}))}},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()},showAddDialog:function(){this.getRolesList(),this.selectRoleId=\"\",this.addDialogVisible=!0},addUser:function(){var e=this;this.addUserForm.roles=this.selectRoleId,Object(i[\"a\"])(this.addUserForm).then((function(){e.$message.success(\"添加用户成功！\"),e.getUserList(),e.addUserForm.username=\"\",e.addUserForm.email=\"\",e.addUserForm.roles=[]})),this.addDialogVisible=!1},removeUserById:function(e){var t=this;this.$confirm(\"此操作将永久删除该用户, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){var s=t.userlist[e].id;Object(i[\"b\"])(s).then((function(e){t.getUserList()})),t.$message.success(\"删除成功！\")})).catch((function(){t.$message.info(\"已取消删除\")}))},showEditDialog:function(e){this.getRolesList(),this.$set(this.editUserForm,\"id\",e.id),this.$set(this.editUserForm,\"username\",e.username),this.$set(this.editUserForm,\"email\",e.email),this.$set(this.editUserForm,\"roles_name\",e.roles_name),this.selectRoleId=e.roles,this.editDialogVisible=!0},editUser:function(){var e=this,t=this.editUserForm.id,s={username:this.editUserForm.username,email:this.editUserForm.email,roles:this.selectRoleId};console.log(s),Object(i[\"c\"])(t,s).then((function(t){e.$message.success(\"修改用户成功！\"),e.getUserList()})),this.editDialogVisible=!1},getRolesList:function(){var e=this;0===this.rolesList.length&&Object(a[\"d\"])().then((function(t){e.rolesList=[];for(var s=t.data,r=0;r<s.length;r++)e.id=s[r].id,e.rolesList.push({id:s[r].id,roleName:s[r].name})}))}}},n=o,d=s(\"cba8\"),u=Object(d[\"a\"])(n,r,l,!1,null,\"7ddddc0a\",null);t[\"default\"]=u.exports}}]);","extractedComments":[]}